<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
    <meta charset="UTF-8">
    <title>메시지 발송 현황 | 관리자</title>
    <link rel="stylesheet" th:href="@{/css/productDonut.css}">
    <link rel="stylesheet" th:href="@{/css/common.css}">
</head>

<body>
<div th:replace="layout/sidebar :: sidebar"></div>
<div class="container">
    <div class="chart-box">
		<div class ="card">
			<div class="chart-wrapper donut-wrapper">
			    <h3>전체 상품 구독 비율</h3>
			    <canvas id="donutChart"></canvas>
			</div>
		</div>
    </div>
</div>

<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<script th:inline="javascript">

	const donutLabels = [[${donutLabels}]];
	const donutData = [[${donutData}]];

	const donutColors = [
		  '#ff6b6b', // 비비드 레드
		  '#4fc3f7', // 선명한 스카이 블루
		  '#ffd166', // 비비드 옐로우
		  '#6c63ff', // 포인트 퍼플 (1개만)
		  '#4dd0a3', // 민트 그린
		  '#ff9f1c', // 비비드 오렌지
		  '#a0cded', // 라이트 블루
		  '#c77dff', // 소프트 바이올렛
		  '#2ec4b6', // 터콰이즈
		  '#e76f51'  // 코랄 브릭
		];

	// 전체 합계
	const totalSubscribers = donutData.reduce((sum, v) => sum + v, 0);

	new Chart(document.getElementById('donutChart'), {
	    type: 'doughnut',
	    data: {
	        labels: donutLabels,
	        datasets: [{
	            data: donutData,
	            backgroundColor: donutColors,
	            borderColor: '#ffffff',
	            borderWidth: 2,
	            hoverOffset: 12
	        }]
	    },
	    options: {
	        responsive: false,
	        maintainAspectRatio: false,
	        plugins: {
	            legend: {
	                position: 'bottom'
	            },
	            tooltip: {
	                callbacks: {
	                    label: function(context) {
	                        const value = context.raw;
	                        const percent = ((value / totalSubscribers) * 100).toFixed(1);

	                        return `${context.label} : ${value}명 (${percent}%)`;
	                    }
	                }
	            }
	        }
	    }
	});




</script>


</body>
</html>
