<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">
<head>
  <meta charset="UTF-8">
  <title>ì •ì‚° ë°°ì • ë¡œê·¸ ëª©ë¡</title>
  <link rel="stylesheet" th:href="@{/css/whole-process-dashboard.css}">
  <link rel="stylesheet" th:href="@{/css/common.css}">
  <style>
    /* ë¡œê·¸ ëª©ë¡ì„ ìœ„í•œ ì¶”ê°€ ìŠ¤íƒ€ì¼ */
    .log-table { width: 100%; border-collapse: collapse; margin-top: 20px; }
    .log-table th, .log-table td { padding: 12px; border-bottom: 1px solid #eee; text-align: left; }
    .log-table th { background-color: #f8f9fa; font-weight: bold; }
    .btn { padding: 5px 10px; border-radius: 4px; text-decoration: none; font-size: 14px; margin-right: 5px; }
    .btn-view { background-color: #4e73df; color: white; }
    .btn-download { background-color: #1cc88a; color: white; }
  </style>
</head>
<body>
<div th:replace="~{layout/sidebar :: sidebar}"></div>

<div class="container">
  <h1>ğŸ“‹ ì •ì‚° ë°°ì¹˜ ë¡œê·¸ ê´€ë¦¬</h1>

  <div class="card filter-container">
    <form th:action="@{/admin/logs}" method="get" class="log-filter-form">
      <div class="filter-group main-date">
        <label>ì¡°íšŒ ê¸°ê°„ ì„¤ì •</label>
        <div class="select-wrapper">
          <select name="year" class="large-select">
            <option value="">ë…„ë„(ì „ì²´)</option>
            <option th:each="y : ${#numbers.sequence(2024, 2026)}"
                    th:value="${y}" th:text="${y} + 'ë…„'"
                    th:selected="${selectedYear == #strings.toString(y)}"></option>
          </select>
          <select name="month" class="large-select">
            <option value="">ì›”(ì „ì²´)</option>
            <option th:each="m : ${#numbers.sequence(1, 12)}"
                    th:value="${m < 10 ? '0'+m : m}" th:text="${m} + 'ì›”'"
                    th:selected="${selectedMonth == (m < 10 ? '0'+m : #strings.toString(m))}"></option>
          </select>
          <select name="day" class="large-select">
            <option value="">ì¼(ì „ì²´)</option>
            <option th:each="d : ${#numbers.sequence(1, 31)}"
                    th:value="${d < 10 ? '0'+d : d}" th:text="${d} + 'ì¼'"
                    th:selected="${selectedDay == (d < 10 ? '0'+d : #strings.toString(d))}"></option>
          </select>
        </div>
      </div>

      <div class="filter-group sort-group">
        <label>ì •ë ¬ ê¸°ì¤€</label>
        <select name="sort" class="large-select full-width">
          <option value="latest" th:selected="${selectedSort == 'latest'}">ìµœê·¼ ë°œìƒìˆœ</option>
          <option value="old" th:selected="${selectedSort == 'old'}">ì˜¤ë˜ëœ ìˆœ</option>
        </select>
      </div>

      <div class="filter-actions">
        <button type="submit" class="btn-search">ê²€ìƒ‰í•˜ê¸°</button>
        <a th:href="@{/admin/logs}" class="btn-reset">ì´ˆê¸°í™”</a>
      </div>
    </form>
  </div>

  <div class="card list-card">
    <table class="log-table">
      <thead>
      <tr>
        <th>íŒŒì¼ëª…</th>
        <th>ìƒíƒœ</th> <th>ìƒì„± ì¼ì‹œ</th>
        <th>ì‘ì—…</th>
      </tr>
      </thead>
      <tbody>
      <tr th:each="file : ${logFiles}">
        <td th:text="${file.fileName}" style="font-family: monospace;"></td>
        <td>
          <span th:if="${file.hasError}" class="badge badge-fail">ERROR</span>
          <span th:unless="${file.hasError}" class="badge badge-success">NORMAL</span>
        </td>
        <td th:text="${#temporals.format(file.dateTime, 'yyyy-MM-dd HH:mm')}"></td>
        <td>
          <a th:href="@{/admin/logs/view/{name}(name=${file.fileName})}" class="btn btn-view">ìƒì„¸ë³´ê¸°</a>
          <a th:href="@{/admin/logs/download/{name}(name=${file.fileName})}" class="btn btn-download">ë‹¤ìš´ë¡œë“œ</a>
        </td>
      </tr>
      </tbody>
    </table>
  </div>
</div>

<style>
  /* í•„í„° ë°•ìŠ¤ ë””ìì¸ ê°•í™” */
  .filter-container {
    padding: 30px;
    margin-bottom: 30px;
    border-radius: 12px;
    background: #ffffff;
    box-shadow: 0 4px 12px rgba(0,0,0,0.05);
  }

  .log-filter-form {
    display: flex;
    flex-wrap: wrap;
    gap: 25px;
    align-items: flex-end;
  }

  .filter-group { display: flex; flex-direction: column; gap: 8px; }
  .main-date { flex: 2; } /* ê°€ë¡œë¡œ ê¸¸ê²Œ ì°¨ì§€ */
  .sort-group { flex: 0.5; }

  .filter-group label {
    font-weight: 700;
    color: #4e73df;
    font-size: 14px;
  }

  .select-wrapper { display: flex; gap: 10px; }

  /* ì…€ë ‰íŠ¸ ë°•ìŠ¤ í¬ê¸° í‚¤ìš°ê¸° */
  .large-select {
    height: 50px;
    padding: 0 15px;
    font-size: 16px;
    border: 2px solid #eaecf4;
    border-radius: 8px;
    background-color: #f8f9fc;
    color: #5a5c69;
    min-width: 120px;
  }

  .large-select.full-width { width: 100%; }

  .large-select:focus {
    border-color: #4e73df;
    outline: none;
    background-color: #fff;
  }

  .btn-search {
    height: 50px;
    padding: 0 30px;
    background-color: #4e73df;
    color: white;
    border: none;
    border-radius: 8px;
    font-weight: bold;
    cursor: pointer;
    transition: 0.3s;
  }

  /* ë°°ì§€ ìŠ¤íƒ€ì¼ ì¶”ê°€ */
  .badge {
    padding: 4px 8px;
    border-radius: 20px;
    font-size: 11px;
    font-weight: bold;
    color: white;
    display: inline-block;
  }
  .badge-fail { background-color: #e74a3b; }    /* ë¹¨ê°„ìƒ‰ */
  .badge-success { background-color: #1cc88a; } /* ì´ˆë¡ìƒ‰ */

  .btn-search:hover { background-color: #2e59d9; }

  .btn-reset {
    height: 50px;
    line-height: 50px;
    padding: 0 20px;
    color: #858796;
    text-decoration: none;
    font-size: 14px;
  }

  .list-card { border-radius: 12px; }
</style>
</body>
</html>
