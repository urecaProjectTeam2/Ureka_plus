[2026-01-26 13:54:53.826] [http-nio-8081-exec-2] ========== 정산 배치 파일 리다이렉션 시작 ==========
[2026-01-26 13:54:53.832] [http-nio-8081-exec-2] >>> 정산 대상 월 (Param): 2025-12-01
[2026-01-26 13:55:07.551] [billing-thread-3] --- [Step 시작] workerStep:partition8 ---
[2026-01-26 13:55:07.582] [billing-thread-8] --- [Step 시작] workerStep:partition1 ---
[2026-01-26 13:55:07.584] [billing-thread-4] --- [Step 시작] workerStep:partition7 ---
[2026-01-26 13:55:07.593] [billing-thread-10] --- [Step 시작] workerStep:partition6 ---
[2026-01-26 13:55:07.642] [billing-thread-6] --- [Step 시작] workerStep:partition3 ---
[2026-01-26 13:55:07.706] [billing-thread-7] --- [Step 시작] workerStep:partition5 ---
[2026-01-26 13:55:07.824] [billing-thread-2] --- [Step 시작] workerStep:partition4 ---
[2026-01-26 13:55:07.891] [billing-thread-9] --- [Step 시작] workerStep:partition2 ---
[2026-01-26 13:55:07.928] [billing-thread-1] --- [Step 시작] workerStep:partition9 ---
[2026-01-26 13:55:08.117] [billing-thread-5] --- [Step 시작] workerStep:partition0 ---
[2026-01-26 14:00:31.460] [billing-thread-4] --- [Step 종료] workerStep:partition7 ---
[2026-01-26 14:00:31.480] [billing-thread-3] --- [Step 종료] workerStep:partition8 ---
[2026-01-26 14:00:31.481] [billing-thread-4] - 최종 상태: COMPLETED
[2026-01-26 14:00:31.481] [billing-thread-3] - 최종 상태: COMPLETED
[2026-01-26 14:00:31.516] [billing-thread-2] --- [Step 종료] workerStep:partition4 ---
[2026-01-26 14:00:31.516] [billing-thread-2] - 최종 상태: COMPLETED
[2026-01-26 14:00:31.516] [billing-thread-7] --- [Step 종료] workerStep:partition5 ---
[2026-01-26 14:00:31.516] [billing-thread-7] - 최종 상태: COMPLETED
[2026-01-26 14:00:32.205] [billing-thread-4] - 읽기 건수: 100002
[2026-01-26 14:00:32.206] [billing-thread-2] - 읽기 건수: 100002
[2026-01-26 14:00:32.206] [billing-thread-7] - 읽기 건수: 100002
[2026-01-26 14:00:32.206] [billing-thread-3] - 읽기 건수: 100002
[2026-01-26 14:00:32.207] [billing-thread-3] - 쓰기 성공: 99999
[2026-01-26 14:00:32.208] [billing-thread-7] - 쓰기 성공: 100000
[2026-01-26 14:00:32.208] [billing-thread-2] - 쓰기 성공: 100000
[2026-01-26 14:00:32.208] [billing-thread-4] - 쓰기 성공: 99997
[2026-01-26 14:00:32.209] [billing-thread-4] - 스킵 건수: 5
[2026-01-26 14:00:32.209] [billing-thread-2] - 스킵 건수: 2
[2026-01-26 14:00:32.210] [billing-thread-3] - 스킵 건수: 3
[2026-01-26 14:00:32.210] [billing-thread-7] - 스킵 건수: 2
[2026-01-26 14:00:41.725] [billing-thread-1] --- [Step 종료] workerStep:partition9 ---
[2026-01-26 14:00:41.725] [billing-thread-1] - 최종 상태: FAILED
[2026-01-26 14:00:41.725] [billing-thread-1] - 읽기 건수: 100000
[2026-01-26 14:00:41.726] [billing-thread-1] - 쓰기 성공: 98996
[2026-01-26 14:00:41.726] [billing-thread-1] - 스킵 건수: 4
[2026-01-26 14:00:41.733] [billing-thread-1] [ERROR 발생] 단계: UNKNOWN, 사용자 ID: 0, 메세지 사용자별 사용량 데이터가 존재하지 않습니다.
[2026-01-26 14:00:48.791] [billing-thread-8] --- [Step 종료] workerStep:partition1 ---
[2026-01-26 14:00:48.791] [billing-thread-8] - 최종 상태: COMPLETED
[2026-01-26 14:00:48.792] [billing-thread-8] - 읽기 건수: 100002
[2026-01-26 14:00:48.793] [billing-thread-8] - 쓰기 성공: 99995
[2026-01-26 14:00:48.793] [billing-thread-8] - 스킵 건수: 7
[2026-01-26 14:00:51.330] [billing-thread-10] --- [Step 종료] workerStep:partition6 ---
[2026-01-26 14:00:51.330] [billing-thread-10] - 최종 상태: COMPLETED
[2026-01-26 14:00:51.330] [billing-thread-10] - 읽기 건수: 100002
[2026-01-26 14:00:51.330] [billing-thread-10] - 쓰기 성공: 99994
[2026-01-26 14:00:51.330] [billing-thread-10] - 스킵 건수: 8
[2026-01-26 14:00:52.462] [billing-thread-5] --- [Step 종료] workerStep:partition0 ---
[2026-01-26 14:00:52.463] [billing-thread-5] - 최종 상태: COMPLETED
[2026-01-26 14:00:52.464] [billing-thread-5] - 읽기 건수: 100002
[2026-01-26 14:00:52.464] [billing-thread-5] - 쓰기 성공: 100000
[2026-01-26 14:00:52.464] [billing-thread-5] - 스킵 건수: 2
[2026-01-26 14:00:55.824] [billing-thread-6] --- [Step 종료] workerStep:partition3 ---
[2026-01-26 14:00:55.824] [billing-thread-6] - 최종 상태: COMPLETED
[2026-01-26 14:00:55.824] [billing-thread-6] - 읽기 건수: 100002
[2026-01-26 14:00:55.824] [billing-thread-6] - 쓰기 성공: 99999
[2026-01-26 14:00:55.824] [billing-thread-6] - 스킵 건수: 3
[2026-01-26 14:00:56.125] [billing-thread-9] --- [Step 종료] workerStep:partition2 ---
[2026-01-26 14:00:56.125] [billing-thread-9] - 최종 상태: COMPLETED
[2026-01-26 14:00:56.125] [billing-thread-9] - 읽기 건수: 100002
[2026-01-26 14:00:56.125] [billing-thread-9] - 쓰기 성공: 100000
[2026-01-26 14:00:56.125] [billing-thread-9] - 스킵 건수: 2
[2026-01-26 14:00:57.866] [http-nio-8081-exec-2] >>> [AfterJob] 최종 실행 상태 : exitCode=FAILED;exitDescription=org.springframework.batch.core.JobExecutionException: Partition handler returned an unsuccessful step
	at org.springframework.batch.core.partition.support.PartitionStep.doExecute(PartitionStep.java:108)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:230)
	at org.springframework.batch.core.job.SimpleStepHandler.handleStep(SimpleStepHandler.java:153)
	at org.springframework.batch.core.job.AbstractJob.handleStep(AbstractJob.java:408)
	at org.springframework.batch.core.job.SimpleJob.doExecute(SimpleJob.java:127)
	at org.springframework.batch.core.job.AbstractJob.execute(AbstractJob.java:307)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher$1.run(TaskExecutorJobLauncher.java:155)
	at org.springframework.core.task.SyncTaskExecutor.execute(SyncTaskExecutor.java:48)
	at org.springframework.batch.core.launch.support.TaskExecutorJobLauncher.run(TaskExecutorJobLauncher.java:146)
	at com.touplus.billing_batch.scheduler.BillingBatchScheduler.runBillingJob(BillingBatchScheduler.java:50)
	at com.touplus.billing_batch.scheduler.BillingBatchController.runBillingJob(BillingBatchController.java:26)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.springframework.web.method.support.InvocableHandlerMethod.doInvoke(InvocableHandlerMethod.java:258)
	at org.springframework.web.method.support.InvocableHandlerMethod.invokeForRequest(InvocableHandlerMethod.java:191)
	at org.springframework.web.servlet.mvc.method.annotation.ServletInvocableHandlerMethod.invokeAndHandle(ServletInvocableHandlerMethod.java:118)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.invokeHandlerMethod(RequestMappingHandlerAdapter.java:991)
	at org.springframework.web.servlet.mvc.method.annotation.RequestMappingHandlerAdapter.handleInternal(RequestMappingHandlerAdapter.java:896)
	at org.springframework.web.servlet.mvc.method.AbstractHandlerMethodAdapter.handle(AbstractHandlerMethodAdapter.java:87)
	at org.springframework.web.servlet.DispatcherServlet.doDispatch(DispatcherServlet.java:1089)
	at org.springframework.web.servlet.DispatcherServlet.doService(DispatcherServlet.java:979)
	at org.springframework.web.servlet.FrameworkServlet.processRequest(FrameworkServlet.java:1014)
	at org.springframework.web.servlet.FrameworkServlet.doGet(FrameworkServlet.java:903)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:564)
	at org.springframework.web.servlet.FrameworkServlet.service(FrameworkServlet.java:885)
	at jakarta.servlet.http.HttpServlet.service(HttpServlet.java:658)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:193)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.tomcat.websocket.server.WsFilter.doFilter(WsFilter.java:51)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.RequestContextFilter.doFilterInternal(RequestContextFilter.java:100)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.FormContentFilter.doFilterInternal(FormContentFilter.java:93)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.springframework.web.filter.CharacterEncodingFilter.doFilterInternal(CharacterEncodingFilter.java:201)
	at org.springframework.web.filter.OncePerRequestFilter.doFilter(OncePerRequestFilter.java:116)
	at org.apache.catalina.core.ApplicationFilterChain.internalDoFilter(ApplicationFilterChain.java:162)
	at org.apache.catalina.core.ApplicationFilterChain.doFilter(ApplicationFilterChain.java:138)
	at org.apache.catalina.core.StandardWrapperValve.invoke(StandardWrapperValve.java:165)
	at org.apache.catalina.core.StandardContextValve.invoke(StandardContextValve.java:88)
	at org.apache.catalina.authenticator.AuthenticatorBase.invoke(AuthenticatorBase.java:482)
	at org.apache.catalina.core.StandardHostValve.invoke(StandardHostValve.java:113)
	at org.apache.catalina.valves.ErrorReportValve.invoke(ErrorReportValve.java:83)
	at org.apache.catalina.core.StandardEngineValve.invoke(StandardEngineValve.java:72)
	at org.apache.catalina.connector.CoyoteAdapter.service(CoyoteAdapter.java:342)
	at org.apache.coyote.http11.Http11Processor.service(Http11Processor.java:399)
	at org.apache.coyote.AbstractProcessorLight.process(AbstractProcessorLight.java:63)
	at org.apache.coyote.AbstractProtocol$ConnectionHandler.process(AbstractProtocol.java:903)
	at org.apache.tomcat.util.net.NioEndpoint$SocketProcessor.doRun(NioEndpoint.java:1774)
	at org.apache.tomcat.util.net.SocketProcessorBase.run(SocketProcessorBase.java:52)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:973)
	at org.apache.tomcat.util.threads.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:491)
	at org.apache.tomcat.util.threads.TaskThread$WrappingRunnable.run(TaskThread.java:63)
	at java.base/java.lang.Thread.run(Thread.java:840)
; org.springframework.retry.RetryException: Non-skippable exception in recoverer while processing
	at org.springframework.batch.core.step.item.FaultTolerantChunkProcessor.lambda$transform$1(FaultTolerantChunkProcessor.java:284)
	at org.springframework.retry.support.RetryTemplate.handleRetryExhausted(RetryTemplate.java:573)
	at org.springframework.retry.support.RetryTemplate.doExecute(RetryTemplate.java:418)
	at org.springframework.retry.support.RetryTemplate.execute(RetryTemplate.java:276)
	at org.springframework.batch.core.step.item.BatchRetryTemplate.execute(BatchRetryTemplate.java:216)
	at org.springframework.batch.core.step.item.FaultTolerantChunkProcessor.transform(FaultTolerantChunkProcessor.java:291)
	at org.springframework.batch.core.step.item.SimpleChunkProcessor.process(SimpleChunkProcessor.java:220)
	at org.springframework.batch.core.step.item.ChunkOrientedTasklet.execute(ChunkOrientedTasklet.java:75)
	at org.springframework.batch.core.step.tasklet.TaskletStep$ChunkTransactionCallback.doInTransaction(TaskletStep.java:383)
	at org.springframework.batch.core.step.tasklet.TaskletStep$ChunkTransactionCallback.doInTransaction(TaskletStep.java:307)
	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:140)
	at org.springframework.batch.core.step.tasklet.TaskletStep$2.doInChunkContext(TaskletStep.java:250)
	at org.springframework.batch.core.scope.context.StepContextRepeatCallback.doInIteration(StepContextRepeatCallback.java:82)
	at org.springframework.batch.repeat.support.RepeatTemplate.getNextResult(RepeatTemplate.java:369)
	at org.springframework.batch.repeat.support.RepeatTemplate.executeInternal(RepeatTemplate.java:206)
	at org.springframework.batch.repeat.support.RepeatTemplate.iterate(RepeatTemplate.java:140)
	at org.springframework.batch.core.step.tasklet.TaskletStep.doExecute(TaskletStep.java:235)
	at org.springframework.batch.core.step.AbstractStep.execute(AbstractStep.java:230)
	at org.springframework.batch.core.partition.support.TaskExecutorPartitionHandler.lambda$createTask$0(TaskExecutorPartitionHandler.java:132)
	at java.base/java.util.concurrent.FutureTask.run(FutureTask.java:264)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1136)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:635)
	at java.base/java.lang.Thread.run(Thread.java:840)
Caused by: com.touplus.billing_batch.common.BillingFatalException: 사용자별 사용량 데이터가 존재하지 않습니다.
	at com.touplus.billing_batch.common.BillingFatalException.dataNotFound(BillingFatalException.java:22)
	at com.touplus.billing_batch.jobs.billing.step.processor.AmountCalculationProcessor.process(AmountCalculationProcessor.java:185)
	at jdk.internal.reflect.GeneratedMethodAccessor34.invoke(Unknown Source)
	at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.base/java.lang.reflect.Method.invoke(Method.java:569)
	at org.springframework.aop.support.AopUtils.invokeJoinpointUsingReflection(AopUtils.java:360)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.invokeJoinpoint(ReflectiveMethodInvocation.java:196)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:163)
	at org.springframework.aop.support.DelegatingIntroductionInterceptor.doProceed(DelegatingIntroductionInterceptor.java:137)
	at org.springframework.aop.support.DelegatingIntroductionInterceptor.invoke(DelegatingIntroductionInterceptor.java:124)
	at org.springframework.aop.framework.ReflectiveMethodInvocation.proceed(ReflectiveMethodInvocation.java:184)
	at org.springframework.aop.framework.CglibAopProxy$DynamicAdvisedInterceptor.intercept(CglibAopProxy.java:728)
	at com.touplus.billing_batch.jobs.billing.step.processor.AmountCalculationProcessor$$SpringCGLIB$$0.process(<generated>)
	at org.springframework.batch.item.support.CompositeItemProcessor.processItem(CompositeItemProcessor.java:91)
	at org.springframework.batch.item.support.CompositeItemProcessor.process(CompositeItemProcessor.java:78)
	at org.springframework.batch.core.step.item.SimpleChunkProcessor.doProcess(SimpleChunkProcessor.java:146)
	at org.springframework.batch.core.step.item.FaultTolerantChunkProcessor.lambda$transform$0(FaultTolerantChunkProcessor.java:228)
	at org.springframework.retry.support.RetryTemplate.doExecute(RetryTemplate.java:357)
	... 20 more

[2026-01-26 14:00:57.870] [http-nio-8081-exec-2] ========== 정산 배치 파일 리다이렉션 종료 ==========
